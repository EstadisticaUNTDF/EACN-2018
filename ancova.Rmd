```{r setup, include = FALSE}
library(tidyverse)
library(knitr)
library(emmeans)
library(car)
library(additivityTests)
library(cowplot)
theme_set(theme_classic())
```

# ANCOVA

 ANOVA (Análisis de la Varianza) y regresión lineal aparentemente no tienen 
 relación entre sí. El primero se ocupa de variables explicatorias cualitativas,
 mientras que el segundo de variables explicatorias cuantitativas. El análisis
 de la Covarianza se ocupa de analizar datos con ambos tipos de variables. 
 De esta forma se obtiene una regresión entre la variable de respuesta y la
 variable explicatoria cuantitativa por cada nivel de la variable explicatoria
 cualitativa. Supongamos que deseamos modelar el peso de acuerdo a la edad y
 el sexo. El modelo máximo tiene cuatro parámetros: dos ordenadas al origen, y
 dos pendientes (una para machos y otra para hembras). 
 
 $$
 peso_{hembra} = a_{hembra} + b_{hembra} \times edad\\
 peso_{macho} = a_{macho} + b_{macho} \times edad
 $$
 Como debe cumplirse con el principio de parsimonia hay que simplificar el 
 modelo lo más posible. En total hay seis modelos posibles, siendo el más 
 complejo el de cuatro parámetros. Puede ser que los necesitemos todos ellos.
 El modelo de cuatro parámetros está representado en la Figura
 \@ref(modelos-figura-ejemplo)-a. Otra forma puede ser que solo necesitemos un
 solo parámetro de pendiente como en la Figura \@ref(modelos-figura-ejemplo)-b.
 Otra opción, es que la ordenada al origen sean iguales pero la pendientes sean
 diferentes, como en la Figura \@ref(modelos-figura-ejemplo)-c. Puede ser que
 la edad no tenga efecto sobre el peso entonces pero que el sexo si tenga efecto
 como en la Figura \@ref(modelos-figura-ejemplo)-d. Entonces este modelo tendrá
 solo dos parámetros. También puede darse el caso opuesto, que la edad tenga
 efecto sobre el peso pero no el sexo, como en la Figura
 \@ref(modelos-figura-ejemplo)-e. La última opción es que ni la edad ni el sexo
 tengan efecto sobre el peso, como en la Figura \@ref(modelos-figura-ejemplo)-f.
 Este último modelo solo tendrá un parámetro.
 
 
 
```{r modelos-figura-ejemplo, echo = FALSE}
base_plot <- ggplot(data = data.frame(x = 0, y = 0)) +
  geom_point(aes(x, y), size = 0, color = "white") +
  labs(x = "Edad", y = "Peso")+
  coord_cartesian(xlim = c(0, 10), ylim = c(0,10))

a <- base_plot +
  geom_abline(intercept = 1, slope = 1) +
  geom_abline(intercept = 2, slope = 1.2, linetype = "dashed") 

b <- base_plot +
  geom_abline(intercept = 1, slope = 1) +
  geom_abline(intercept = 2, slope = 1, linetype = "dashed") 

c <- base_plot +
  geom_abline(intercept = 1, slope = 1) +
  geom_abline(intercept = 1, slope = 1.2, linetype = "dashed") 

d <- base_plot +
  geom_abline(intercept = 1, slope = 0) +
  geom_abline(intercept = 2, slope = 0, linetype = "dashed")

e <- base_plot +
  geom_abline(intercept = 1, slope = 1) +
  geom_abline(intercept = 1, slope = 1, linetype = "dashed") 

f <- base_plot +
  geom_abline(intercept = 1, slope = 0) +
  geom_abline(intercept = 1, slope = 0, linetype = "dashed") 

plot_grid(a, b, c, d, e, f, labels = "auto")

```
 
 